<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link href=https://wangzhengquan.github.io/blog/Algorithms/Using%20two%20stacks%20to%20Evaluate%20an%20Expression/ rel=canonical><link rel=icon href=../../assets/images/favicon.png><meta name=generator content="mkdocs-1.3.1, mkdocs-material-8.3.9"><title>Using two stacks to Evaluate an Expression - My Blogs</title><link rel=stylesheet href=../../assets/stylesheets/main.1d29e8d0.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.cbb835fc.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><script>__md_scope=new URL("../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme data-md-color-primary=none data-md-color-accent=none> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> </div> <div data-md-component=announce> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../.. title="My Blogs" class="md-header__button md-logo" aria-label="My Blogs" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> My Blogs </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Using two stacks to Evaluate an Expression </span> </div> </div> </div> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg> </button> </nav> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title="My Blogs" class="md-nav__button md-logo" aria-label="My Blogs" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg> </a> My Blogs </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../.. class=md-nav__link> 简介 </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2 type=checkbox id=__nav_2 checked> <label class=md-nav__link for=__nav_2> Algorithms <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Algorithms data-md-level=1> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Algorithms </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../Using_a_Stack_to_Evaluate_an_Expression/ class=md-nav__link> Using a Stack to Evaluate an Expression </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" data-md-toggle=toc type=checkbox id=__toc> <a href=./ class="md-nav__link md-nav__link--active"> Using two stacks to Evaluate an Expression </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3 type=checkbox id=__nav_3> <label class=md-nav__link for=__nav_3> Shell <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Shell data-md-level=1> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Shell </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Shell/Shell%20Command/ class=md-nav__link> Shell Command </a> </li> <li class=md-nav__item> <a href=../../Shell/Shell%20Script/ class=md-nav__link> Shell Script </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4 type=checkbox id=__nav_4> <label class=md-nav__link for=__nav_4> MacOS <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=MacOS data-md-level=1> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> MacOS </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../MacOS/Launching%20Custom%20Daemons%20Using%20launchd/ class=md-nav__link> Launching Custom Daemons Using launchd </a> </li> <li class=md-nav__item> <a href=../../MacOS/MacOS%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/ class=md-nav__link> MacOS常用命令 </a> </li> <li class=md-nav__item> <a href=../../MacOS/MacOS%E5%BF%85%E5%A4%87/ class=md-nav__link> MacOS必备 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_5 type=checkbox id=__nav_5> <label class=md-nav__link for=__nav_5> Unbuntu <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Unbuntu data-md-level=1> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> Unbuntu </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Unbuntu/fix-the-no-wifi-adapter-found-error-on-ubuntu/ class=md-nav__link> Fix “No WiFi Adapter Found” Error on Ubuntu </a> </li> <li class=md-nav__item> <a href=../../Unbuntu/Ubuntu%E5%BF%85%E5%A4%87/ class=md-nav__link> Ubuntu必备 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_6 type=checkbox id=__nav_6> <label class=md-nav__link for=__nav_6> 编辑器 <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=编辑器 data-md-level=1> <label class=md-nav__title for=__nav_6> <span class="md-nav__icon md-icon"></span> 编辑器 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Editor/Sublime/ class=md-nav__link> Sublime </a> </li> <li class=md-nav__item> <a href=../../Editor/VSCode/ class=md-nav__link> VSCode </a> </li> <li class=md-nav__item> <a href=../../Editor/vim%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/ class=md-nav__link> Vim常用命令 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_7 type=checkbox id=__nav_7> <label class=md-nav__link for=__nav_7> GCC <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=GCC data-md-level=1> <label class=md-nav__title for=__nav_7> <span class="md-nav__icon md-icon"></span> GCC </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../GCC/GCC%20compiling%20processes/ class=md-nav__link> GCC compiling processes </a> </li> <li class=md-nav__item> <a href=../../GCC/GCC%20Linking/ class=md-nav__link> GCC Linking </a> </li> <li class=md-nav__item> <a href=../../GCC/Tools%20for%20Manipulating%20Object%20Files/ class=md-nav__link> Tools for Manipulating Object Files </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_8 type=checkbox id=__nav_8> <label class=md-nav__link for=__nav_8> GDB <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=GDB data-md-level=1> <label class=md-nav__title for=__nav_8> <span class="md-nav__icon md-icon"></span> GDB </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../GDB/gdb%20demo/ class=md-nav__link> gdb demo </a> </li> <li class=md-nav__item> <a href=../../GDB/gdbnotes-x86-64.pdf class=md-nav__link> Summary of GDB commands </a> </li> <li class=md-nav__item> <a href=../../GDB/GDB%20Cheat%20Sheet.pdf class=md-nav__link> GDB Cheat Sheet </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_9 type=checkbox id=__nav_9> <label class=md-nav__link for=__nav_9> 编程语言 <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=编程语言 data-md-level=1> <label class=md-nav__title for=__nav_9> <span class="md-nav__icon md-icon"></span> 编程语言 </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_9_1 type=checkbox id=__nav_9_1> <label class=md-nav__link for=__nav_9_1> Assembly <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Assembly data-md-level=2> <label class=md-nav__title for=__nav_9_1> <span class="md-nav__icon md-icon"></span> Assembly </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../ProgramingLanguage/assembly/Inline%20assembly%20for%20x86/ class=md-nav__link> Inline assembly for x86 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_9_2 type=checkbox id=__nav_9_2> <label class=md-nav__link for=__nav_9_2> C <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=C data-md-level=2> <label class=md-nav__title for=__nav_9_2> <span class="md-nav__icon md-icon"></span> C </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../ProgramingLanguage/C/C_takeaway/ class=md-nav__link> C语言要点 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_9_3 type=checkbox id=__nav_9_3> <label class=md-nav__link for=__nav_9_3> C++ <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=C++ data-md-level=2> <label class=md-nav__title for=__nav_9_3> <span class="md-nav__icon md-icon"></span> C++ </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../ProgramingLanguage/C%2B%2B/operator%20overload/ class=md-nav__link> operator overload </a> </li> <li class=md-nav__item> <a href=../../ProgramingLanguage/C%2B%2B/friend/ class=md-nav__link> friend </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_10 type=checkbox id=__nav_10> <label class=md-nav__link for=__nav_10> 收藏 <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=收藏 data-md-level=1> <label class=md-nav__title for=__nav_10> <span class="md-nav__icon md-icon"></span> 收藏 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../save/ai_tools.md class=md-nav__link> AI Tools </a> </li> <li class=md-nav__item> <a href=../../save/online_university/ class=md-nav__link> 网络大学 </a> </li> <li class=md-nav__item> <a href=../../save/web_site/ class=md-nav__link> 网址收藏 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_11 type=checkbox id=__nav_11> <label class=md-nav__link for=__nav_11> Markdown <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Markdown data-md-level=1> <label class=md-nav__title for=__nav_11> <span class="md-nav__icon md-icon"></span> Markdown </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Markdown/Markdown%20Syntax/ class=md-nav__link> Markdown Syntax </a> </li> <li class=md-nav__item> <a href=../../Markdown/Markdown%E6%A8%A1%E7%89%88/ class=md-nav__link> Markdown模版 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_12 type=checkbox id=__nav_12> <label class=md-nav__link for=__nav_12> Git <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Git data-md-level=1> <label class=md-nav__title for=__nav_12> <span class="md-nav__icon md-icon"></span> Git </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Git/Git%20commands/ class=md-nav__link> Git commands </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_13 type=checkbox id=__nav_13> <label class=md-nav__link for=__nav_13> SSH <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=SSH data-md-level=1> <label class=md-nav__title for=__nav_13> <span class="md-nav__icon md-icon"></span> SSH </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../SSH/SSH%20command/ class=md-nav__link> SSH command </a> </li> <li class=md-nav__item> <a href=../../SSH/SSH%20install/ class=md-nav__link> SSH install </a> </li> <li class=md-nav__item> <a href=../../SSH/SSH%20login%20without%20password/ class=md-nav__link> SSH login without password </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_14 type=checkbox id=__nav_14> <label class=md-nav__link for=__nav_14> Vagrant <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Vagrant data-md-level=1> <label class=md-nav__title for=__nav_14> <span class="md-nav__icon md-icon"></span> Vagrant </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Vagrant/Vagrant%20tutorial/ class=md-nav__link> Vagrant tutorial </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_15 type=checkbox id=__nav_15> <label class=md-nav__link for=__nav_15> docker <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=docker data-md-level=1> <label class=md-nav__title for=__nav_15> <span class="md-nav__icon md-icon"></span> docker </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../docker/docker/ class=md-nav__link> docker </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1>Using two stacks to Evaluate an Expression</h1> <p>Infix Expressions are harder for Computers to evaluate because of the additional work needed to decide precedence. Infix notation is how expressions are written and recognized by humans and, generally, input to programs. Given that they are harder to evaluate, they are generally converted to one of the two remaining forms. A very well known algorithm for converting an infix notation to a postfix notation is <a href=https://en.wikipedia.org/wiki/Shunting_yard_algorithm>Shunting Yard Algorithm</a> by Edgar Dijkstra.</p> <p>This algorithm takes as input an Infix Expression and produces a queue that has this expression converted to postfix notation. The same algorithm can be modified so that it outputs the result of the evaluation of expression instead of a queue. The trick is using two stacks instead of one, one for operands, and one for operators.</p> <pre><code>1. While there are still tokens to be read in,
  1.1 Get the next token.
  1.2 If the token is:
      1.2.1 A number: push it onto the value stack.
      1.2.2 A variable: get its value, and push onto the value stack.
      1.2.3 A left parenthesis: push it onto the operator stack.
      1.2.4 A right parenthesis:
        1 While the thing on top of the operator stack is not a 
          left parenthesis,
            1 Pop the operator from the operator stack.
            2 Pop the value stack twice, getting two operands.
            3 Apply the operator to the operands, in the correct order.
            4 Push the result onto the value stack.
        2 Pop the left parenthesis from the operator stack, and discard it.
      1.2.5 An operator (call it thisOp):
        1 While the operator stack is not empty, and the top thing on the
          operator stack has the same or greater precedence as thisOp,
          1 Pop the operator from the operator stack.
          2 Pop the value stack twice, getting two operands.
          3 Apply the operator to the operands, in the correct order.
          4 Push the result onto the value stack.
        2 Push thisOp onto the operator stack.
2. While the operator stack is not empty,
    1 Pop the operator from the operator stack.
    2 Pop the value stack twice, getting two operands.
    3 Apply the operator to the operands, in the correct order.
    4 Push the result onto the value stack.
3. At this point the operator stack should be empty, and the value
  stack should have only one value in it, which is the final result.
</code></pre> <p>Implementation: It should be clear that this algorithm runs in linear time – each number or operator is pushed onto and popped from Stack only once.</p> <pre><code class=language-java>/**
 * https://www.geeksforgeeks.org/expression-evaluation
 * &lt;p&gt;
 * Using two stacks , one for operands, and one for operators to Evaluate an Expression in one pass
 */

import java.util.Map;
import java.util.Stack;
import java.util.TreeMap;

public class CalculatorX {
  private final static Map&lt;Character, Integer&gt; OPERATOR_MAP = new TreeMap&lt;&gt;();

  static {
    // &lt;Operator, Precedence&gt;
    OPERATOR_MAP.put('+', 1);
    OPERATOR_MAP.put('-', 1);
    OPERATOR_MAP.put('*', 2);
    OPERATOR_MAP.put('/', 2);
    OPERATOR_MAP.put('^', 3); // power

  }

  public static double evaluate(String expression) {
    char[] tokens = expression.toCharArray();
    // Stack for numbers: 'values'
    Stack&lt;Double&gt; values = new Stack&lt;&gt;();
    // Stack for Operators: 'ops'
    Stack&lt;Character&gt; ops = new Stack&lt;&gt;();
    for (int i = 0; i &lt; tokens.length; i++) {
      // Current token is a whitespace, skip it
      if (Character.isWhitespace(tokens[i]))
        continue;

      // Current token is a number, push it to stack for numbers
      if (isDigit(tokens[i])) {
        StringBuffer sbuf = new StringBuffer();

        // There may be more than one digits in number
        // while (i &lt; tokens.length &amp;&amp; tokens[i] &gt;= '0' &amp;&amp; tokens[i] &lt;= '9')
        while (i &lt; tokens.length &amp;&amp; isDigit(tokens[i]))
          sbuf.append(tokens[i++]);
        values.push(Double.parseDouble(sbuf.toString()));

        /* right now the i points to the character next to the digit, since the for loop also increases the i, we would
         skip one token position; we need to decrease the value of i by 1 to correct the offset.*/
        i--;
      } else if (tokens[i] == '(') {
        // Current token is an opening brace, push it to 'ops'
        ops.push(tokens[i]);
      } else if (tokens[i] == ')') {
        // Closing brace encountered, solve entire brace
        while (ops.peek() != '(')
          values.push(applyOp(ops.pop(), values.pop(), values.pop()));
        //Pop the left parenthesis from the stack and discard it
        if (ops.isEmpty() || ops.pop() != '(') {
          throw new IllegalArgumentException(&quot;The expression contained unbalanced parentheses &quot;);
        }
      } else if (isOperator(tokens[i])) {
        // Current token is an operator.

        /* While top of 'ops' has same or greater precedence to current token, which is an operator.
        Apply operator on top of 'ops' to top two elements in values stack*/
        while (!ops.empty() &amp;&amp; ops.peek() != '(' &amp;&amp; precedence(ops.peek()) &gt; precedence(tokens[i]))
          values.push(applyOp(ops.pop(), values.pop(), values.pop()));
        // Push current token to 'ops'.
        ops.push(tokens[i]);
      } else {
        throw new IllegalArgumentException(&quot;Invalid token found:&quot; + tokens[i]);
      }
    }

    // Entire expression has been parsed at this point, apply remaining ops to remaining values
    while (!ops.empty()) {
      char op = ops.pop();
      if (op != '(')
        values.push(applyOp(op, values.pop(), values.pop()));
      else
        throw new IllegalArgumentException(&quot;The infixQ contained unbalanced parentheses &quot;);
    }


    // Top of 'values' contains result, return it
    return values.pop();
  }

  private static boolean isOperator(char c) {
    return c == '+' || c == '-' || c == '*' || c == '/' || c == '^';
  }

  private static boolean isDigit(char c) {
    // c &gt;= '0' &amp;&amp; c &lt;= '9' || c == '.'
    return Character.isDigit(c) || c == '.';
  }

  // Returns true if 'op2' has higher or same precedence as 'op1', otherwise returns false.
  public static int precedence(char op) {
    return OPERATOR_MAP.get(op);
  }

  // A utility method to apply an operator 'op' on operands 'a' and 'b'. Return the result.
  public static double applyOp(char op, double b, double a) {
    switch (op) {
      case '+':
        return a + b;
      case '-':
        return a - b;
      case '*':
        return a * b;
      case '/':
        if (b == 0) throw new UnsupportedOperationException(&quot;Cannot divide by zero&quot;);
        return a / b;
      case '^':
        return Math.pow(a, b);
    }
    return 0;
  }

  // Driver method to test above methods
  public static void main(String[] args) {
    System.out.println(CalculatorX.evaluate(&quot;10 + 2 * 6&quot;));
    System.out.println(CalculatorX.evaluate(&quot;1.01 * 2 + 12&quot;));
    System.out.println(CalculatorX.evaluate(&quot;100 * ( 2 + 12 )&quot;));
    System.out.println(CalculatorX.evaluate(&quot;100 * ( 2 + 12 ) / 14 + 2^3&quot;));
    System.out.println(CalculatorX.evaluate(&quot;2^3&quot;));
  }
}
</code></pre> <blockquote> <p><a href=https://www.geeksforgeeks.org/expression-evaluation/ >https://www.geeksforgeeks.org/expression-evaluation/</a></p> </blockquote> <p>\</p> </article> </div> </div> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Footer> <a href=../Using_a_Stack_to_Evaluate_an_Expression/ class="md-footer__link md-footer__link--prev" aria-label="Previous: Using a Stack to Evaluate an Expression" rel=prev> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </div> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> Previous </span> Using a Stack to Evaluate an Expression </div> </div> </a> <a href=../../Shell/Shell%20Command/ class="md-footer__link md-footer__link--next" aria-label="Next: Shell Command" rel=next> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> Next </span> Shell Command </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.b97dbffb.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script> <script src=../../assets/javascripts/bundle.6c7ad80a.min.js></script> </body> </html>